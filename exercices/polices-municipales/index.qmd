---
title: "La France des polices municipales"
description: "Cartographier les initiatives sécuritaires locales"
date: 2023-06-25
categories: [La police des sorties]
citation: 
  url: https://l-attestation.github.io/exercices/polices-municipales/ 
image: https://upload.wikimedia.org/wikipedia/commons/b/b4/Tolima_-_Champ_de_sorgho.JPG
draft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!
---

## Charger les principaux packages

```{r}
library(here)
library(tidyverse)
library(huxtable)
```

## Récupérer les données

Les effectifs des polices municipales par communes pour les années 2012 à 2021 ont été publiées par le Ministère de l'Intérieur sur le site [data.gouv.fr](https://www.data.gouv.fr/fr/datasets/police-municipale-effectifs-par-commune/).

Le code suivant télécharge le fichier de données dans un sous-dossier data (à ne faire qu'une fois, évidemment).

```{r}
polices_municipales_path = here("data", "polices_municipales.ods")
# download.file(url = "https://www.data.gouv.fr/fr/datasets/r/ad814337-074c-459b-add1-d78df9e6d85f",
#               destfile = polices_municipales_path)
```

## Les lire

```{r}
polices_municipales = readODS::read_ods(polices_municipales_path, skip = 8, col_names = FALSE) |> 
  select(A, D, E, "F", G, H) |>
    rename(code_departement = A,
           nom_commune = D,
           pop_pm = E,
           municipaux = "F",
           asvp = G,
           garde_champetres = H)
```

::: {.callout-caution}
On croirait que le concepteur de ces données a pris un malin plaisir à les rendre **complètement inexploitables**. Il n'y a pas de code postal pour la commune. Et aucune cohérence dans la manière d'écrire leur nom. 
:::

```{r}
polices_municipales |> 
  head(n = 20) |> 
  as_hux() |> 
  set_number_format(NA) |> 
  theme_mondrian()
```

## Les recoder

D'où un recodage particulièrement laborieux, pour parvenir à joindre ces données avec une base contenant la couche cartographique des communes.

